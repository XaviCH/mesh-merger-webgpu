(()=>{"use strict";var e,t,r,n,i={685:(e,t,r)=>{r.d(t,{Ib:()=>n,WT:()=>i});var n=1e-6,i="undefined"!=typeof Float32Array?Float32Array:Array;Math.random,Math.PI,Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)})},975:(e,t,r)=>{r.d(t,{G3:()=>s,U1:()=>a,Ue:()=>i,zB:()=>o});var n=r(685);function i(){var e=new n.WT(16);return n.WT!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function a(e,t,r,i){var a,s,o,c,h,u,l,f,m,p,d,v,g,U,y,w,b,C,B,x,E,M,O,P,I=i[0],z=i[1],T=i[2],A=Math.hypot(I,z,T);return A<n.Ib?null:(I*=A=1/A,z*=A,T*=A,a=Math.sin(r),o=1-(s=Math.cos(r)),c=t[0],h=t[1],u=t[2],l=t[3],f=t[4],m=t[5],p=t[6],d=t[7],v=t[8],g=t[9],U=t[10],y=t[11],w=I*I*o+s,b=z*I*o+T*a,C=T*I*o-z*a,B=I*z*o-T*a,x=z*z*o+s,E=T*z*o+I*a,M=I*T*o+z*a,O=z*T*o-I*a,P=T*T*o+s,e[0]=c*w+f*b+v*C,e[1]=h*w+m*b+g*C,e[2]=u*w+p*b+U*C,e[3]=l*w+d*b+y*C,e[4]=c*B+f*x+v*E,e[5]=h*B+m*x+g*E,e[6]=u*B+p*x+U*E,e[7]=l*B+d*x+y*E,e[8]=c*M+f*O+v*P,e[9]=h*M+m*O+g*P,e[10]=u*M+p*O+U*P,e[11]=l*M+d*O+y*P,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}var s=function(e,t,r,n,i){var a,s=1/Math.tan(t/2);return e[0]=s/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0?(a=1/(n-i),e[10]=(i+n)*a,e[14]=2*i*n*a):(e[10]=-1,e[14]=-2*n),e};function o(e,t,r,i){var a,s,o,c,h,u,l,f,m,p,d=t[0],v=t[1],g=t[2],U=i[0],y=i[1],w=i[2],b=r[0],C=r[1],B=r[2];return Math.abs(d-b)<n.Ib&&Math.abs(v-C)<n.Ib&&Math.abs(g-B)<n.Ib?function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}(e):(l=d-b,f=v-C,m=g-B,a=y*(m*=p=1/Math.hypot(l,f,m))-w*(f*=p),s=w*(l*=p)-U*m,o=U*f-y*l,(p=Math.hypot(a,s,o))?(a*=p=1/p,s*=p,o*=p):(a=0,s=0,o=0),c=f*o-m*s,h=m*a-l*o,u=l*s-f*a,(p=Math.hypot(c,h,u))?(c*=p=1/p,h*=p,u*=p):(c=0,h=0,u=0),e[0]=a,e[1]=c,e[2]=l,e[3]=0,e[4]=s,e[5]=h,e[6]=f,e[7]=0,e[8]=o,e[9]=u,e[10]=m,e[11]=0,e[12]=-(a*d+s*v+o*g),e[13]=-(c*d+h*v+u*g),e[14]=-(l*d+f*v+m*g),e[15]=1,e)}},160:(e,t,r)=>{r.d(t,{AK:()=>m,EU:()=>d,Fv:()=>f,IH:()=>c,JG:()=>o,TE:()=>u,TK:()=>y,Ue:()=>i,Zh:()=>w,al:()=>s,cs:()=>h,d9:()=>a,dC:()=>g,hi:()=>U,kC:()=>p,lu:()=>v,tk:()=>l});var n=r(685);function i(){var e=new n.WT(3);return n.WT!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function a(e){var t=new n.WT(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function s(e,t,r){var i=new n.WT(3);return i[0]=e,i[1]=t,i[2]=r,i}function o(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function c(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e}function h(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e}function u(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return Math.hypot(r,n,i)}function l(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function f(e,t){var r=t[0],n=t[1],i=t[2],a=r*r+n*n+i*i;return a>0&&(a=1/Math.sqrt(a)),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e}function m(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function p(e,t,r){var n=t[0],i=t[1],a=t[2],s=r[0],o=r[1],c=r[2];return e[0]=i*c-a*o,e[1]=a*s-n*c,e[2]=n*o-i*s,e}function d(e,t){var r=e[0],n=e[1],i=e[2],a=t[0],s=t[1],o=t[2],c=Math.sqrt(r*r+n*n+i*i)*Math.sqrt(a*a+s*s+o*o),h=c&&m(e,t)/c;return Math.acos(Math.min(Math.max(h,-1),1))}var v=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e},g=function(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e},U=h,y=u,w=function(e){var t=e[0],r=e[1],n=e[2];return Math.hypot(t,r,n)};i()},686:(e,t,r)=>{r.d(t,{x:()=>u});class n{vertices=[];faces=[];constructor(e){this.vertex_size=6+3*e.length*2,this.meshes=e}generateVBO(){let e=[];const t=(e,t)=>e.concat(Array.from(t));return this.faces.forEach((r=>{const n=r.vertices,i=r.directions.reduce(t,[]),a=Array.from(r.normal);e=e.concat(Array.from(n[0].position),...n[0].directions.reduce(t,[]),a,...i,Array.from(n[1].position),...n[1].directions.reduce(t,[]),a,...i,Array.from(n[2].position),...n[2].directions.reduce(t,[]),a,...i)})),new Float32Array(e)}}var i=r(160);const a=i.Ue();function s(e,t,r,n){return 1/6*i.AK(i.kC(i.Ue(),i.lu(i.Ue(),t,e),i.lu(i.Ue(),r,e)),i.lu(i.Ue(),n,e))}function o(e,t){const r=e[0],n=e[1],i=e[2];let o=s(t,a,r,n)>=0;return s(t,r,n,i)>=0!=s(a,r,n,i)>=0&&o==s(t,a,n,i)>=0&&o==s(t,a,i,r)>=0}function c(e,t){const r=i.kC(i.Ue(),i.lu(i.Ue(),e[1],e[0]),i.lu(i.Ue(),e[2],e[0])),n=-i.AK(i.lu(i.Ue(),a,e[0]),r)/i.AK(i.lu(i.Ue(),t,a),r);return i.IH(i.Ue(),a,i.dC(i.Ue(),i.lu(i.Ue(),t,a),i.al(n,n,n)))}function h(e,t,r){let n=function(e,t){let r=i.lu(i.Ue(),t[1],t[0]),n=i.lu(i.Ue(),t[2],t[0]),a=i.lu(i.Ue(),e,t[0]),s=i.AK(r,r),o=i.AK(r,n),c=i.AK(n,n),h=i.AK(a,r),u=i.AK(a,n),l=s*c-o*o,f=(c*h-o*u)/l,m=(s*u-o*h)/l;return[1-f-m,f,m]}(e,t),a=n[0],s=n[1],o=n[2];return i.IH(i.Ue(),i.IH(i.Ue(),i.dC(i.Ue(),r[0],i.al(a,a,a)),i.dC(i.Ue(),r[1],i.al(s,s,s))),i.dC(i.Ue(),r[2],i.al(o,o,o)))}function u(...e){const t=new n(e);for(const r of e){let n=r.vertices.map((e=>{const r=e.parametrization;let n=t.faces.find((e=>o(e.vertices.map((e=>e.position)),r))),a=[];if(void 0!==n){const e=n.vertices,t=e[0].directions.length,s=e.map((e=>e.position));let o=c(s,r);for(let n=0;n<t;++n){let t=h(o,s,[i.IH(i.Ue(),e[0].position,e[0].directions[n]),i.IH(i.Ue(),e[1].position,e[1].directions[n]),i.IH(i.Ue(),e[2].position,e[2].directions[n])]);a.push(i.lu(i.Ue(),t,r))}}return{position:r,directions:[...a,i.lu(i.Ue(),e.position,r)]}})),a=r.faces.map((e=>{const t=e.parametrization;let a=e.vertices.map((e=>n[r.vertices.indexOf(e)])),s=[];const o=a[0].directions.length-1;for(let e=0;e<o;++e){let r=i.Ue();i.IH(r,a[0].directions[e],a[1].directions[e]),i.IH(r,r,a[2].directions[e]),s.push(i.lu(r,i.Fv(r,i.tk(r,i.hi(r,r,i.al(3,3,3)))),t))}return{vertices:a,normal:t,directions:[...s,i.lu(i.Ue(),e.normal,t)]}}));if(t.vertices.forEach((e=>{let t=r.faces.find((t=>o(t.vertices.map((e=>e.parametrization)),e.position)));if(void 0===t)throw Error("No se ha parametrizado correctamente la malla");const n=t.vertices.map((e=>e.parametrization));let a=h(c(n,e.position),n,[t.vertices[0].position,t.vertices[1].position,t.vertices[2].position]);e.directions.push(i.lu(i.Ue(),a,e.position))})),t.faces.forEach((e=>{const t=e.vertices,r=t[0].directions.length-1;let n=i.Ue();i.IH(n,t[0].directions[r],t[1].directions[r]),i.IH(n,n,t[2].directions[r]),e.directions.push(i.lu(n,i.Fv(n,i.tk(n,i.hi(n,n,i.al(3,3,3)))),e.normal))})),e.indexOf(r)+1==e.length)return t.vertices=n,t.faces=a,t;t.vertices=t.vertices.concat(n),t.faces=t.faces.concat(a)}return t}},399:(e,t,r)=>{r.d(t,{J:()=>s}),r(666),r(26),r(250);var n=r(160);const i=n.Ue();function a(e){const t=e.vertices[0].parametrization,r=n.Ue();let a=n.lu(n.Ue(),t,e.vertices[1].parametrization),s=n.lu(n.Ue(),t,e.vertices[2].parametrization);n.kC(r,a,s);let o=n.dC(n.Ue(),r,n.al(-1,-1,-1)),c=n.IH(n.Ue(),t,r),h=n.IH(n.Ue(),t,o);return n.TK(h,i)>n.TK(c,i)&&n.IH(r,o,i),n.Fv(r,r),e.parametrization=r,r}function s(e){let t=e.copy();function r(e){let t=e.vertices;return n.Zh(n.kC(n.Ue(),n.lu(n.Ue(),t[1].parametrization,t[0].parametrization),n.lu(n.Ue(),t[2].parametrization,t[0].parametrization)))/2}t.vertices.forEach((e=>e.parametrization=n.d9(e.position)));let i=t.faces.reduce(((e,t)=>e+r(t)),0)/t.faces.length;function s(e){const t=e.faces;let a=t.reduce(((t,r)=>t+function(e,t){let r=e.vertices.filter((e=>e!==t)),i=n.lu(n.Ue(),r[0].parametrization,t.parametrization),a=n.lu(n.Ue(),r[1].parametrization,t.parametrization);return n.EU(i,a)}(r,e)),0),s=t.reduce(((e,t)=>e+r(t)),0);return(2*Math.PI-a)/(s/3+i)}function o(e){const t=e.neighbors(),r=t.size;let i=n.Ue();return t.forEach((e=>n.IH(i,i,e.parametrization))),n.cs(i,i,n.al(r,r,r)),i}let c=10*t.vertices.length;for(t.vertices.forEach((e=>e.gaussianCurvature=s(e)));0!=c--;){let e=t.vertices.sort(((e,t)=>Math.abs(t.gaussianCurvature)-Math.abs(e.gaussianCurvature))),a=!0;for(let c of e){let e=o(c);if(n.TE(e,c.parametrization)>.001){n.JG(c.parametrization,e),i=t.faces.reduce(((e,t)=>e+r(t)),0)/t.faces.length,c.gaussianCurvature=s(c),c.neighbors().forEach((e=>e.gaussianCurvature=s(e))),a=!1;break}}}const h=t.vertices.length;let u=t.vertices.reduce(((e,t)=>n.IH(e,e,t.parametrization)),n.Ue());return n.hi(u,u,n.al(h,h,h)),t.vertices.forEach((e=>n.lu(e.parametrization,e.parametrization,u))),t.vertices.forEach((e=>{n.dC(e.parametrization,n.Fv(e.parametrization,e.parametrization),n.al(.5,.5,.5))})),t.faces.forEach(a),t}},102:(e,t,r)=>{function n(e){var t=document.createElement("div");return t.innerHTML=e.trim(),t.firstChild}r.d(t,{JQ:()=>s,TC:()=>i,k6:()=>a});const i=n('\n<div role="status" class="w-40 h-40 interactive-border flex justify-center items-center">\n    <svg aria-hidden="true" class="w-8 h-8 mr-2 text-gray-200 animate-spin dark:text-gray-600 fill-blue-600" viewBox="0 0 100 101" fill="none" xmlns="http://www.w3.org/2000/svg">\n        <path d="M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z" fill="currentColor"/>\n        <path d="M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z" fill="currentFill"/>\n    </svg>\n</div>\n'),a=n('\n<div role="status" class="w-48 h-48 interactive-border flex justify-center items-center">\n    <svg aria-hidden="true" class="w-8 h-8 mr-2 text-gray-200 animate-spin dark:text-gray-600 fill-blue-600" viewBox="0 0 100 101" fill="none" xmlns="http://www.w3.org/2000/svg">\n        <path d="M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z" fill="currentColor"/>\n        <path d="M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z" fill="currentFill"/>\n    </svg>\n</div>\n'),s=n('\n<div class="w-48 h-48 relative group interactive-border">\n    <canvas class="w-48 h-48">\n    </canvas>\n    <div class="absolute top-0 left-0 w-48 h-48 p-4 pt-8 items-center justify-center hidden group-hover:flex flex-wrap opacity-80">\n        <input type="range" value="50" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700">\n        <button type="button" class="w-12 h-12 rounded hover:bg-gray-800">\n            <i class="fa fa-trash"></i>\n        </button>\n    </div>\n</div>\n')},250:(e,t,r)=>{r.d(t,{L:()=>a});var n=r(160);r(26);const i=n.Ue();class a{vertices=[];constructor(e,t,r,n){this.vertices=[e,t,r],this.normal=n,e.faces.push(this),t.faces.push(this),r.faces.push(this)}generateNormal(){const e=this.vertices[0].position,t=n.Ue();let r=n.lu(n.Ue(),e,this.vertices[1].position),a=n.lu(n.Ue(),e,this.vertices[2].position);n.kC(t,r,a);let s=n.dC(n.Ue(),t,n.al(-1,-1,-1)),o=n.IH(n.Ue(),e,t),c=n.IH(n.Ue(),e,s);return n.TK(c,i)>n.TK(o,i)&&n.IH(t,s,i),n.Fv(t,t),this.normal=t,t}copy(){return new a(...this.vertices,n.JG(n.Ue(),this.normal))}contains(e){return this.vertices.includes(e)}static and(...e){return new Set(e[0].vertices.filter((t=>e.filter((e=>e.contains(t))).length==e.length)))}static or(...e){return new Set(Array.from(e).reduce(((e,t)=>e.concat(t.vertices)),[]))}}},666:(e,t,r)=>{r.d(t,{K:()=>s});var n=r(160),i=r(250),a=r(26);class s{vertices=[];faces=[];vertex_size=6;generateVBO(){let e=[];return this.faces.forEach((t=>{const r=Array.from(t.normal),n=t.vertices;e=e.concat(Array.from(n[0].position),r,Array.from(n[1].position),r,Array.from(n[2].position),r)})),new Float32Array(e)}static fromString(e){let t=new s,r=e.split(/[\r\n]+/g),o=[];return r.forEach((e=>{let r=e.trim().split(" "),s=r[0];if("v"==s)t.vertices.push(new a.X(n.al(parseFloat(r[1]),parseFloat(r[2]),parseFloat(r[3]))));else if("vn"==s)o.push(n.al(parseFloat(r[1]),parseFloat(r[2]),parseFloat(r[3])));else if("f"==s){let e=r[1].split("/"),n=r[2].split("/"),a=r[3].split("/"),s=parseInt(e[2])-1,c=new i.L(t.vertices[parseInt(e[0])-1],t.vertices[parseInt(n[0])-1],t.vertices[parseInt(a[0])-1],o[s]);if(void 0===o[s]&&c.generateNormal(),t.faces.push(c),5==r.length){let n=new i.L(t.vertices[parseInt(r[4].split("/")[0])-1],t.vertices[parseInt(e[0])-1],t.vertices[parseInt(a[0])-1],o[s]);void 0===o[s]&&n.generateNormal(),t.faces.push(n)}}})),t.normalize(),t}normalize(){const e=this.vertices.length;let t=this.vertices.reduce(((e,t)=>n.IH(e,e,t.position)),n.Ue());n.hi(t,t,n.al(e,e,e));let r=n.dC(n.Ue(),t,n.al(-1,-1,-1));this.vertices.forEach((e=>n.IH(e.position,e.position,r)));const i=n.Ue();let a=this.vertices[0].position,s=n.TE(a,i);this.vertices.forEach((e=>{let t=n.TE(e.position,i);t>s&&(a=e.position,s=t)}));let o=n.cs(n.Ue(),n.al(.5,.5,.5),n.al(s,s,s));this.vertices.forEach((e=>n.dC(e.position,e.position,o)))}copy(){let e=new s;e.vertices=this.vertices.map((e=>e.copy()));const t=e.vertices;return e.faces=this.faces.map((e=>new i.L(t[this.vertices.indexOf(e.vertices[0])],t[this.vertices.indexOf(e.vertices[1])],t[this.vertices.indexOf(e.vertices[2])],e.normal))),e}readFile(e){const t=new FileReader;t.onload=()=>{},t.readAsText(e)}}},26:(e,t,r)=>{r.d(t,{X:()=>i});var n=r(250);class i{faces=[];constructor(e){this.position=e}copy(){return new i(this.position)}neighbors(){let e=n.L.or(...this.faces);return e.delete(this),e}}},973:(e,t,r)=>{r.a(e,(async(e,n)=>{try{r.d(t,{V:()=>c});var i=r(613),a=r(975),s=e([i]);const o={device:(i=(s.then?(await s)():s)[0]).Uh,format:i.p5,alphaMode:"premultiplied"};class c{constructor(e,t){this.mesh=e,this.canvas=t,this.context=t.getContext("webgpu"),this.context.configure(o),this.generateVBO(),this.generateUniforms(),this.generateShaders()}generateVBO(){this.VBO=this.mesh.generateVBO(),this.VBOBuffer=i.Uh.createBuffer({size:this.VBO.byteLength,usage:GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST}),i.Uh.queue.writeBuffer(this.VBOBuffer,0,this.VBO),this.VBOBufferLayout={arrayStride:24+3*this.mesh.meshes.length*4*2,attributes:[{format:"float32x3",offset:0,shaderLocation:0},...this.mesh.meshes.map((e=>({format:"float32x3",offset:12+3*this.mesh.meshes.indexOf(e)*4,shaderLocation:this.mesh.meshes.indexOf(e)+1}))),{format:"float32x3",offset:12+3*this.mesh.meshes.length*4,shaderLocation:this.mesh.meshes.length+1},...this.mesh.meshes.map((e=>({format:"float32x3",offset:12+3*this.mesh.meshes.length*4+3*this.mesh.meshes.indexOf(e)*4+12,shaderLocation:this.mesh.meshes.length+this.mesh.meshes.indexOf(e)+2})))]}}generateUniforms(){this.projection=a.Ue(),a.G3(this.projection,Math.PI/4,1,.1,10),this.view=a.Ue(),a.zB(this.view,[0,.75,1.5],[0,0,0],[0,1,0]),this.model=a.Ue(),this.scalars=new Float32Array(this.mesh.meshes.map((e=>0))),this.uniformBuffer=i.Uh.createBuffer({size:208,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.bindGroupLayout=i.Uh.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.VERTEX,buffer:{}}]}),this.bindGroup=i.Uh.createBindGroup({layout:this.bindGroupLayout,entries:[{binding:0,resource:{buffer:this.uniformBuffer}}]}),this.pipelineLayout=i.Uh.createPipelineLayout({bindGroupLayouts:[this.bindGroupLayout]})}generateShaders(){this.shaderModule=this.createShaderModule(),this.renderPipeline=i.Uh.createRenderPipeline({layout:this.pipelineLayout,vertex:{module:this.shaderModule,entryPoint:"vertexMain",buffers:[this.VBOBufferLayout]},fragment:{module:this.shaderModule,entryPoint:"fragmentMain",targets:[{format:i.p5}]},depthStencil:{format:"depth24plus",depthWriteEnabled:!0,depthCompare:"less"}})}createShaderModule(){let e=this.mesh.meshes.map((e=>`scalar${this.mesh.meshes.indexOf(e)}: f32`)).join(","),t=this.mesh.meshes.map((e=>{let t=this.mesh.meshes.indexOf(e);return`@location(${t+1}) direction${t}: vec3f`})).join(","),r=this.mesh.meshes.map((e=>{let t=this.mesh.meshes.indexOf(e);return`direction${t}*transformations.scalar${t}`})).join("+"),n=this.mesh.meshes.map((e=>{let t=this.mesh.meshes.indexOf(e);return`@location(${this.mesh.meshes.length+t+2}) normal${t}: vec3f`})).join(","),a=this.mesh.meshes.map((e=>{let t=this.mesh.meshes.indexOf(e);return`normal${t}*transformations.scalar${t}`})).join("+");return i.Uh.createShaderModule({code:`\n                struct TransformData {\n                    model: mat4x4f,\n                    view: mat4x4f,\n                    projection: mat4x4<f32>,\n                    ${e}\n                }\n        \n                struct Fragment {\n                    @builtin(position) Position: vec4f,\n                    @location(0) Color: vec4f\n                };\n        \n                @binding(0) @group(0) var<uniform> transformations: TransformData;\n        \n                @vertex\n                fn vertexMain(@location(0) pos: vec3f, ${t}, @location(${this.mesh.meshes.length+1}) normal : vec3f, ${n} ) -> Fragment {\n                    var output: Fragment;\n                    var finalPos: vec3f = pos + ${r};\n                    output.Position = transformations.projection * transformations.view * transformations.model * vec4f(finalPos, 1);\n                    var finalNormal: vec3f = normalize(normal + ${a});\n                    output.Color = vec4f((finalNormal+1)/2, 1);\n                    return output;\n                }\n        \n        \n                @fragment\n                fn fragmentMain(@location(0) Color: vec4f) -> @location(0) vec4f {\n                    return Color;\n                }\n            `})}update(){i.Uh.queue.writeBuffer(this.uniformBuffer,0,this.model),i.Uh.queue.writeBuffer(this.uniformBuffer,64,this.view),i.Uh.queue.writeBuffer(this.uniformBuffer,128,this.projection),i.Uh.queue.writeBuffer(this.uniformBuffer,192,new Float32Array(this.scalars)),a.U1(this.model,this.model,.005,[0,1,0])}}n()}catch(e){n(e)}}))},613:(e,t,r)=>{r.a(e,(async(e,n)=>{try{if(r.d(t,{Uh:()=>a,p5:()=>s,sY:()=>o}),!navigator.gpu)throw new Error("WebGPU not supported on this browser.");const i=await navigator.gpu.requestAdapter();if(!i)throw new Error("No appropriate GPUAdapter found.");const a=await i.requestDevice(),s=navigator.gpu.getPreferredCanvasFormat();function o(...e){let t=a.createCommandEncoder();e.forEach((e=>{e.update();let r=a.createTexture({size:[e.canvas.width,e.canvas.height,1],format:"depth24plus",usage:GPUTextureUsage.RENDER_ATTACHMENT}),n=t.beginRenderPass({colorAttachments:[{view:e.context.getCurrentTexture().createView(),loadOp:"clear",clearValue:{r:0,g:0,b:0,a:0},storeOp:"store"}],depthStencilAttachment:{view:r.createView(),depthLoadValue:1,depthLoadOp:"clear",depthClearValue:1,depthStoreOp:"store"}});n.setPipeline(e.renderPipeline),n.setVertexBuffer(0,e.VBOBuffer),n.setBindGroup(0,e.bindGroup),n.draw(e.VBO.length/e.mesh.vertex_size),n.end()})),a.queue.submit([t.finish()])}n()}catch(c){n(c)}}),1)},608:(e,t,r)=>{r.a(e,(async(e,n)=>{try{r.d(t,{x:()=>u});var i=r(613),a=r(975),s=e([i]);const o=(i=(s.then?(await s)():s)[0]).Uh.createShaderModule({code:"\n        struct TransformData {\n            model: mat4x4f,\n            view: mat4x4f,\n            projection: mat4x4<f32>,\n        }\n\n        struct Fragment {\n            @builtin(position) Position: vec4f,\n            @location(0) Color: vec4f\n        };\n\n        @binding(0) @group(0) var<uniform> transformations: TransformData;\n\n        @vertex\n        fn vertexMain(@location(0) pos: vec3f, @location(1) normal : vec3f) -> Fragment {\n            var output: Fragment;\n            output.Position = transformations.projection * transformations.view * transformations.model * vec4f(pos, 1);\n            output.Color = vec4f((normal+1)/2, 1);\n            return output;\n        }\n\n\n        @fragment\n        fn fragmentMain(@location(0) Color: vec4f) -> @location(0) vec4f {\n            return Color;\n        }\n    "}),c={device:i.Uh,format:i.p5,alphaMode:"premultiplied"},h={arrayStride:24,attributes:[{format:"float32x3",offset:0,shaderLocation:0},{format:"float32x3",offset:12,shaderLocation:1}]};class u{constructor(e,t){this.mesh=e,this.canvas=t,this.context=t.getContext("webgpu"),this.context.configure(c),this.generateVBO(),this.generateUniforms(),this.generateShaders()}generateVBO(){this.VBOBufferLayout=h,this.VBO=this.mesh.generateVBO(),this.VBOBuffer=i.Uh.createBuffer({size:this.VBO.byteLength,usage:GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST}),i.Uh.queue.writeBuffer(this.VBOBuffer,0,this.VBO)}generateUniforms(){this.projection=a.Ue(),this.view=a.Ue(),this.model=a.Ue(),a.G3(this.projection,Math.PI/4,1,.1,10),a.zB(this.view,[0,.75,1.5],[0,0,0],[0,1,0]),this.uniformBuffer=i.Uh.createBuffer({size:192,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.bindGroupLayout=i.Uh.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.VERTEX,buffer:{}}]}),this.bindGroup=i.Uh.createBindGroup({layout:this.bindGroupLayout,entries:[{binding:0,resource:{buffer:this.uniformBuffer}}]}),this.pipelineLayout=i.Uh.createPipelineLayout({bindGroupLayouts:[this.bindGroupLayout]})}generateShaders(){this.shaderModule=o,this.renderPipeline=i.Uh.createRenderPipeline({layout:this.pipelineLayout,vertex:{module:this.shaderModule,entryPoint:"vertexMain",buffers:[this.VBOBufferLayout]},fragment:{module:this.shaderModule,entryPoint:"fragmentMain",targets:[{format:i.p5}]},depthStencil:{format:"depth24plus",depthWriteEnabled:!0,depthCompare:"less"}})}update(){i.Uh.queue.writeBuffer(this.uniformBuffer,0,this.model),i.Uh.queue.writeBuffer(this.uniformBuffer,64,this.view),i.Uh.queue.writeBuffer(this.uniformBuffer,128,this.projection),a.U1(this.model,this.model,.005,[0,1,0])}}n()}catch(e){n(e)}}))},225:(e,t,r)=>{r.a(e,(async(e,t)=>{try{var n=r(613),i=r(666),a=r(608),s=r(102),o=r(973),c=r(686),h=r(399),u=r(160),l=e([n,a,o]);[n,a,o]=l.then?(await l)():l;const f=["cube","cube_deformed","sphere","sphere_def","cow","rat","wolf","tiger"],m=document.getElementById("new-mesh-wrap"),p=document.getElementById("mesh-frame-grid"),d=document.getElementById("add-mesh-frame");let v,g,U=[];function y(){U.splice(U.indexOf(this.parentElement.parentElement.scene),1),this.parentElement.parentElement.remove()}async function w(){let e=s.k6.cloneNode(!0);p.insertBefore(e,d.nextSibling);let t=s.JQ.cloneNode(!0);t.children[1].children[1].onclick=y,new Promise((e=>{setTimeout((()=>e(new a.x(this.mesh,t.children[0]))),100)})).then((r=>{t.scene=r,U.push(r),p.insertBefore(t,e),e.remove()})),document.getElementById("close-new-mesh").click()}async function b(){f.forEach((async e=>{let t=s.TC.cloneNode(!0);m.appendChild(t),console.log("1"+e),fetch(`assets/${e}.obj`).then((async e=>{let r=document.createElement("canvas");r.setAttribute("class","w-40 h-40 interactive-border"),r.onclick=w,r.mesh=i.K.fromString(await e.text()),(0,n.sY)(new a.x(r.mesh,r)),m.insertBefore(r,t),t.remove()}))}))}function C(){const e=document.getElementById("main-scene");document.getElementById("merge-button").onclick=()=>{v=new o.V((0,c.x)(...U.map((e=>(0,h.J)(e.mesh)))),e)}}function B(){if((0,n.sY)(...U),v){let e=U.reduce(((e,t)=>e+Number(t.canvas.nextElementSibling.children[0].value)),0);for(let t=0;t<U.length;++t)v.scalars[t]=0==e?0:Math.pow(Number(U[t].canvas.nextElementSibling.children[0].value),2)/e/100;(0,n.sY)(v)}requestAnimationFrame(B)}$(document).ready((async()=>{b(),C(),await fetch("assets/dense_sphere.obj").then((async e=>{g=i.K.fromString(await e.text()),g.vertices.forEach((e=>e.parametrization=u.d9(e.position))),g.faces.forEach((e=>e.parametrization=u.d9(e.normal)))})),B()})),t()}catch(x){t(x)}}))}},a={};function s(e){var t=a[e];if(void 0!==t)return t.exports;var r=a[e]={exports:{}};return i[e](r,r.exports,s),r.exports}e="function"==typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",t="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",r="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",n=e=>{e&&e.d<1&&(e.d=1,e.forEach((e=>e.r--)),e.forEach((e=>e.r--?e.r++:e())))},s.a=(i,a,s)=>{var o;s&&((o=[]).d=-1);var c,h,u,l=new Set,f=i.exports,m=new Promise(((e,t)=>{u=t,h=e}));m[t]=f,m[e]=e=>(o&&e(o),l.forEach(e),m.catch((e=>{}))),i.exports=m,a((i=>{var a;c=(i=>i.map((i=>{if(null!==i&&"object"==typeof i){if(i[e])return i;if(i.then){var a=[];a.d=0,i.then((e=>{s[t]=e,n(a)}),(e=>{s[r]=e,n(a)}));var s={};return s[e]=e=>e(a),s}}var o={};return o[e]=e=>{},o[t]=i,o})))(i);var s=()=>c.map((e=>{if(e[r])throw e[r];return e[t]})),h=new Promise((t=>{(a=()=>t(s)).r=0;var r=e=>e!==o&&!l.has(e)&&(l.add(e),e&&!e.d&&(a.r++,e.push(a)));c.map((t=>t[e](r)))}));return a.r?h:s()}),(e=>(e?u(m[r]=e):h(f),n(o)))),o&&o.d<0&&(o.d=0)},s.d=(e,t)=>{for(var r in t)s.o(t,r)&&!s.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s(225)})();